<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>App-365 Bolos</title>

<style>
* {
  box-sizing: border-box;
  font-family: Arial, Helvetica, sans-serif;
}

body {
  margin: 0;
  background: #f2f2f2;
}

/* ===== LOGIN ===== */
#login {
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  background: #f2f2f2;
}

.login-box {
  background: #ffffff;
  padding: 30px;
  border-radius: 16px;
  width: 320px;
  text-align: center;
}

.login-box h1 {
  margin-bottom: 10px;
}

.login-box input {
  width: 100%;
  padding: 14px;
  font-size: 16px;
  margin: 15px 0;
}

.login-box button {
  width: 100%;
  padding: 14px;
  font-size: 16px;
  background: #ff9800;
  color: #fff;
  border: none;
  border-radius: 8px;
  cursor: pointer;
}

/* ===== APP ===== */
#app {
  display: none;
  background: #f2f2f2;
  min-height: 100vh;
}

header {
  background: #ff9800;
  color: #fff;
  padding: 20px;
  text-align: center;
}

.grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
  gap: 16px;
  padding: 20px;
}

.card {
  background: #fff;
  border-radius: 14px;
  padding: 20px;
  text-align: center;
  cursor: pointer;
}

.emoji {
  font-size: 48px;
  margin-bottom: 10px;
}

/* ===== MODAL ===== */
.modal {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  overflow-y: auto;
}

.modal-content {
  background: #fff;
  margin: 40px auto;
  padding: 20px;
  border-radius: 12px;
  max-width: 600px;
}

.close {
  float: right;
  cursor: pointer;
  font-size: 20px;
}

/* ===== INSTALL BUTTON ===== */
#installBtn {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: #ff9800;
  color: #fff;
  padding: 12px 18px;
  border-radius: 30px;
  display: none;
  cursor: pointer;
  font-size: 14px;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="login">
  <div class="login-box">
    <h1>ðŸŽ‚ App-365 Bolos</h1>
    <input type="password" id="senha" placeholder="Digite a senha">
    <button onclick="entrar()">Entrar</button>
  </div>
</div>

<!-- APP -->
<div id="app">
  <header>
    <h2>365 Bolos Sem GlÃºten, Sem AÃ§Ãºcar e Sem Leite</h2>
    <p>1 bolo por dia, o ano inteiro â€” sem culpa</p>
  </header>

  <div class="grid" id="lista"></div>
</div>

<!-- MODAL -->
<div class="modal" id="modal">
  <div class="modal-content" id="modalContent">
    <span class="close" onclick="fechar()">âœ–</span>
  </div>
</div>

<!-- INSTALL -->
<div id="installBtn" onclick="instalar()">ðŸ“² Instalar App</div>

<script>
const SHEET_ID = "1q-B4wKUJtpmjh3MoXae9xR0HVg9EYvsF2QD3guVm_Os";
const ABA = "sheet1";
const URL = `https://opensheet.elk.sh/${SHEET_ID}/${ABA}`;

let receitas = [];
let deferredPrompt = null;

/* ===== LOGIN ===== */
function entrar() {
  if (document.getElementById("senha").value === "1950*") {
    document.getElementById("login").style.display = "none";
    document.getElementById("app").style.display = "block";
    carregar();
  } else {
    alert("Senha incorreta");
  }
}

/* ===== EMOJIS ===== */
function emojiPorNome(nome) {
  nome = nome.toLowerCase();
  if (nome.includes("chocolate")) return "ðŸ«";
  if (nome.includes("banana")) return "ðŸŒ";
  if (nome.includes("laranja")) return "ðŸŠ";
  if (nome.includes("cenoura")) return "ðŸ¥•";
  if (nome.includes("coco")) return "ðŸ¥¥";
  if (nome.includes("maÃ§Ã£")) return "ðŸŽ";
  return "ðŸŽ‚";
}

/* ===== LOAD ===== */
function carregar() {
  fetch(URL)
    .then(r => r.json())
    .then(d => {
      receitas = d;
      const lista = document.getElementById("lista");
      lista.innerHTML = "";

      d.forEach((r, i) => {
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <div class="emoji">${emojiPorNome(r.nome)}</div>
          <strong>${r.nome}</strong>
        `;
        card.onclick = () => abrir(i);
        lista.appendChild(card);
      });
    });
}

/* ===== MODAL ===== */
function abrir(i) {
  const r = receitas[i];
  document.getElementById("modalContent").innerHTML = `
    <span class="close" onclick="fechar()">âœ–</span>
    <h2>${emojiPorNome(r.nome)} ${r.nome}</h2>
    <p><b>IdentificaÃ§Ã£o:</b> ${r.identificacao}</p>
    <p><b>Ingredientes:</b> ${r.ingredientes}</p>
    <p><b>Tempo:</b> ${r.tempo}</p>
    <p><b>Temperatura:</b> ${r.temperatura}</p>
    <p><b>Modo de Preparo:</b> ${r.modo_preparo}</p>
    <p><b>TÃ©cnicas:</b> ${r.tecnicas}</p>
    <p><b>Rendimento:</b> ${r.rendimento}</p>
    <p><b>Dificuldade:</b> ${r.dificuldade}</p>
    <p><b>Categoria:</b> ${r.categoria}</p>
    <p><b>ObservaÃ§Ãµes:</b> ${r.observacoes}</p>
  `;
  document.getElementById("modal").style.display = "block";
}

function fechar() {
  document.getElementById("modal").style.display = "none";
}

/* ===== INSTALL APP (PWA) ===== */
window.addEventListener("beforeinstallprompt", (e) => {
  e.preventDefault();
  deferredPrompt = e;
  document.getElementById("installBtn").style.display = "block";
});

function instalar() {
  if (deferredPrompt) {
    deferredPrompt.prompt();
    deferredPrompt.userChoice.then(() => {
      deferredPrompt = null;
      document.getElementById("installBtn").style.display = "none";
    });
  }
}
</script>

</body>
</html>
